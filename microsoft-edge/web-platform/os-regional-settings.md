---
title: 操作系统区域数据显示
description: 用户和 Web 开发人员如何使用 Microsoft Edge 中的 OS 区域格式来改进站点体验
author: MSEdgeTeam
ms.author: msedgedevrel
ms.topic: conceptual
ms.prod: microsoft-edge
ms.date: 08/19/2022
ms.openlocfilehash: 2cb269963ac139c62f50fc9e0f322ced3a21306a
ms.sourcegitcommit: 1958cc52c3e61705a4872a9f22d5fe414560d5af
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/23/2022
ms.locfileid: "12730209"
---
# <a name="operating-system-regional-data-display"></a>操作系统区域数据显示

Microsoft Edge 提供操作系统 (OS) 区域首选项信息，以帮助网站作者在使用 Microsoft Edge 查看网站时在其网站上创建区域体验。 此功能允许网站作者向专门更改其在 OS 中的区域首选项以反映其个人偏好的用户提供价值。

用户希望查看根据首选项打印的日期、时间、数字和其他格式。 例如，美国地理区域将 **2022 年 7 月 2** 日转换为 **2022 年 7 月 2 日**。  另一个地理区域可能会将同一日期转换为 **2022 年 2 月 7 日，** 因为它们读取的月份和日期相反。


<!-- ====================================================================== -->
## <a name="regional-format"></a>区域格式

为了反映用户对数据显示方式的区域首选项（如日期) ） (，Microsoft Edge 在 **“设置**：**共享其他 OS 区域格式**”菜单的 **“语言**”部分中提供了一个新选项。

![“共享其他 OS 区域格式”菜单，其中选择了“受限 (默认) 选项](media/os-regional-setting.png)

授予对此设置的访问权限允许网站查看比之前可能更多的用户特定区域首选项。  更改其 OS 区域首选项的用户现在可能会看到其首选项自动反映在更多网站中。


<!-- ====================================================================== -->
## <a name="os-regional-data-display-codes"></a>OS 区域数据显示代码

用户的格式设置首选项抽象为简单的区域代码，Web 应用程序使用该代码推断上面所述的日期、时间和其他格式设置首选项的各种详细信息。

网站可以将内置的国际化 API 与区域代码配合使用，以便将信息正确格式化为用户的首选项。  国际化 API 可以通过网络节省大量 MB 的数据传输，使网站保持较小，并使网站能够快速轻松地适应不同的区域。

通常，网站的国际化用户体验仅与他们能够为当前用户确定的区域代码一样好。

区域代码是双字母语言代码，后跟连字符和双字母区域代码。  Microsoft Edge 使用 ICU 来了解区域代码。 ICU 是 Unicode 标准的国际化 API 的实现。  有关详细信息，请参阅 [ICU-TC 主页](https://icu.unicode.org/home)。

若要设置用户的语言首选项，Microsoft Edge 会在首次安装时从 OS 获取默认值。 然后，用户可以更改语言首选项， `edge://settings/languages` 并按优先级顺序对其进行排序。

![“设置>语言”页的“首选语言”部分](media/preferred-languages.png)

UI、HTTP 标头和 API 按如下所示进行交互：

| 语言或区域数据 | 用户影响 |
|--------|-------------------------|
| **“设置语言”** > 页中的**首选语言****** | 为呈现 Microsoft Edge 而选择的语言。 此语言/区域还用于设置日期、时间和数字等值的格式。 |
|  `accept-language` HTTP 标头 | 区域代码列表 (设置**语言** > **首选语言****中** > 定义的，) 发送到服务器以允许网站显示正确的语言。 Microsoft Edge 按 **edge://settings/languages** 中指定的顺序发送区域代码。 |
| `navigator.language` API (和类似)  | 插入网站的代码允许浏览器显示正确的区域格式 (，如**设置** > **语言** > 首选**语言**中定义的，) 用户输入和本地生成的其他内容。 |


<!-- ====================================================================== -->
## <a name="regional-data-display-options"></a>区域数据显示选项

用户在 Microsoft Edge 上有三个选项，用于选择浏览器将共享的有关其区域的信息级别：

* **有限 (默认) **
* **始终不建议 () **
* **从不**


#### <a name="limited"></a>受限

默认值，建议值为 **Limited**。 此设置仅使用用户当前 Microsoft Edge 首选语言和用户选择的 OS 区域首选项的有效组合。 **有限** 可确保对于语言处理，网站将提供一致的语言体验 (不会将语言混合在不可预测的组合) 中。

“ **受限** ”选项比较了从浏览器当前首选显示语言派生的区域代码的语言部分，以及来自 OS 设置的区域代码，如果语言部件匹配，并且生成的区域代码是有效的组合，则会将区域代码作为默认区域设置提供给网站。

如果 OS 指定的区域语言与 Microsoft Edge 的首选语言不匹配， **则“受限** ”选项将充当 **“从未选择过** ”，并会回退到派生自浏览器首选显示语言的区域代码。

注意： **受限** 选项类似于当前用于公开 OS 区域代码的 Firefox 行为，如 [区域首选项 - Firefox 源文档 (mozilla.org) ](https://firefox-source-docs.mozilla.org/intl/locale.html#regional-preferences)中所述。


#### <a name="always"></a>始终

如果 **始终 (不建议选择) ** ，则用户的 OS 区域首选项将提供给网站，而没有任何限制或限制。 用户可能会面临指纹识别和网站兼容性问题， (不一致地使用语言和格式) 。 请参阅下面的“避免潜在滥用”部分。) 


#### <a name="never"></a>从不

用户可以通过选择 **“从不**”来禁用 OS 区域信息的共享。 **“从不**”选项仍允许网站读取区域信息，但确实会阻止用户向网站内容公开所做的任何特定 OS 区域自定义。 相反，浏览器的首选显示语言用于派生默认区域。


<!-- ====================================================================== -->
## <a name="policy-controls"></a>策略控件

Microsoft Edge 中的相关新策略 **ShareOSRegionThroughJavaScriptLocale** 提供了企业或企业级默认配置的设置。  此设置接受具有以下潜在值的整数：

|数字| 描述 |
|--------|-------------------------|
| 1 | 受限 |
| 2 | 始终 |
| 3 | 从不 |

此外，较旧的策略 [ApplicationLocaleValue](/DeployEdge/microsoft-edge-policies#applicationlocalevalue) 设置 Microsoft Edge 区域设置并锁定它以防止用户更改它。


<!-- ====================================================================== -->
## <a name="avoiding-potential-misuse"></a>避免潜在的滥用

我们认为， **限制** 是大多数用户的正确选项。 **有限** 尊重用户的区域首选项，同时引入网站滥用此信息的风险最小。


#### <a name="fingerprinting-entropy"></a>指纹爏

操作系统区域信息可能会被滥用，以损害用户的隐私。  区域信息将帮助黑客建立指纹熵。 结合当前平台中许多其他预先存在的熵位，用户可以唯一地识别，从而造成更多潜在的次要危害。

虽然用户的区域和语言已通过 Web 平台可用，但用户通常会遇到跨地理位置相似的知名区域代码。 由于样本大小太大，因此任何特定区域代码突出显示的风险很小，因此风险很小。 如果用户将其 OS 首选项更改为唯一语言 + 区域，则网站可能能够识别总体中的异常情况，并唯一标识关联的用户。


#### <a name="content-presentation"></a>内容演示文稿

操作系统区域信息也可能被滥用，并导致网站语言演示不一致。 Microsoft Edge 为网站开发人员提供多种语言和区域 API。  网站可以在一个位置处理区域信息，同时从另一个位置派生语言首选项。

当语言和区域信息是自我一致的时，网站用来汇集其内容演示文稿的 API 并不重要。 但是，如果网站从多个 API 读取语言信息，并且这些 API 返回不同的语言代码，则网站可能会无意中开始混合匹配区域首选项，从而导致奇怪的用户体验。 例如，将语言和区域首选项混合在一起的措辞，例如“Email在 miércoles 上发送，5 de enero de 2021”。


<!-- ====================================================================== -->
## <a name="developer-details"></a>开发人员详细信息

**“共享其他 OS 区域格式**”的新设置直接影响 JavaScript `Intl` 对象的默认区域值以及使用默认区域 (（例如`Date`构造函数) ）的所有其他 JavaScript API。

`Intl`当为对象的构造函数 (（如`DateTimeFormat`) ）提供现有区域代码时，其行为将保持不变。 但是，如果未提供特定的区域代码，构造函数将使用 **默认区域代码**。 新的用户首选项也会影响依赖于默认区域代码的其他日期和时间格式 API，例如 `Date`。

例如，可以使用用户的默认区域代码 (创建一个 `DateTimeFormat` ，并通过以下表达式检查) ：

```js
Intl.DateTimeFormat().resolvedOptions().locale
```

平台中的其他区域，例如 `accept-languages` 通过 HTTP/HTTPS GET 请求发送到服务器的标头，以及 `navigator.language`<!--listed in table above--> 和 `navigator.languages` API 不受 OS 共享的区域信息的影响。
