---
description: 使用 Windows 运行时 (WinRT) 从 JavaScript 应用调用本机 Windows API。
title: 适用于 JavaScript (WinRT) Windows 运行时
author: MSEdgeTeam
ms.author: msedgedevrel
ms.topic: article
ms.prod: microsoft-edge
ms.technology: windows-integration
keywords: Windows 运行时、WinRT、PWA、JavaScript
ms.date: 12/02/2020
ROBOTS: NOINDEX,NOFOLLOW
ms.openlocfilehash: 3bd67f052d0a836c754f7b58d0625e09ae8781cd
ms.sourcegitcommit: a35a6b5bbc21b7df61d08cbc6b074b5325ad4fef
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/17/2020
ms.locfileid: "11232745"
---
# <span data-ttu-id="18b5b-104">适用于 JavaScript (WinRT) Windows 运行时</span><span class="sxs-lookup"><span data-stu-id="18b5b-104">Windows Runtime (WinRT) for JavaScript</span></span>  

[!INCLUDE [deprecation-note](../includes/legacy-edge-note.md)]  

<span data-ttu-id="18b5b-105">[Windows 运行时](/windows/uwp/get-started/universal-application-platform-guide#how-the-universal-windows-platform-relates-to-windows-runtime-apis)\(或简单的 WinRT\) 是支持跨所有[Windows 10](/uwp/extension-sdks/device-families-overview)设备系列运行的通用[Windows 平台](/windows/uwp/get-started/universal-application-platform-guide)\(UWP\) 应用的本机 API 的集合。</span><span class="sxs-lookup"><span data-stu-id="18b5b-105">The [Windows Runtime](/windows/uwp/get-started/universal-application-platform-guide#how-the-universal-windows-platform-relates-to-windows-runtime-apis) \(or simply WinRT\) is the collection of native APIs that power the [Universal Windows Platform](/windows/uwp/get-started/universal-application-platform-guide) \(UWP\) apps that run across all [Windows 10 device families](/uwp/extension-sdks/device-families-overview).</span></span>  <span data-ttu-id="18b5b-106">WinRT API 被计划为许多不同的语言，包括 C#、C++、Visual Basic和 JavaScript。</span><span class="sxs-lookup"><span data-stu-id="18b5b-106">WinRT APIs are projected into a number of different languages, including C#, C++, Visual Basic, and JavaScript.</span></span>  

<span data-ttu-id="18b5b-107">作为 Web 开发人员，当 Web 应用作为从进程启动的已安装 [Windows 10](../progressive-web-apps/windows-features.md#set-up-and-run-your-universal-windows-app) 应用 \(而不是浏览器\) 运行时，你可以从 JavaScript 请求这些本机 Windows `wwahost.exe` API。</span><span class="sxs-lookup"><span data-stu-id="18b5b-107">As a web developer, you may request these native Windows APIs from JavaScript when your web app is [running as an installed Windows 10 app](../progressive-web-apps/windows-features.md#set-up-and-run-your-universal-windows-app) \(launched from the `wwahost.exe` process, rather than the browser\).</span></span>  <span data-ttu-id="18b5b-108">此外，作为 Windows 10 应用运行的网站可能还使用 [Microsoft Edge Webview](#webview) 控件显示远程和本地 Web 内容以及 [MSApp](#msapp) API，用于 blob 和流处理等。</span><span class="sxs-lookup"><span data-stu-id="18b5b-108">Additionally, your website running as a Windows 10 app may also use the [Microsoft Edge webview](#webview) control to display remote and local web content and [MSApp](#msapp) APIs for blob and stream handling, among other things.</span></span>  

<span data-ttu-id="18b5b-109">下面是可用于所有 Windows 10 应用的顶级 WinRT 命名空间区域：</span><span class="sxs-lookup"><span data-stu-id="18b5b-109">Here are the top-level WinRT namespace areas available to all Windows 10 apps:</span></span>  

| <span data-ttu-id="18b5b-110">WinRT 命名空间</span><span class="sxs-lookup"><span data-stu-id="18b5b-110">WinRT Namespace</span></span> | <span data-ttu-id="18b5b-111">描述</span><span class="sxs-lookup"><span data-stu-id="18b5b-111">Description</span></span> |  
|:--- |:--- |  
| <span data-ttu-id="18b5b-112">[AI](/uwp/api/windows.AI.MachineLearning.Preview) \(Preview\) </span><span class="sxs-lookup"><span data-stu-id="18b5b-112">[AI](/uwp/api/windows.AI.MachineLearning.Preview) \(Preview\)</span></span> | <span data-ttu-id="18b5b-113">包含使应用能够加载机器学习模型、将数据绑定为输入并评估结果的类。</span><span class="sxs-lookup"><span data-stu-id="18b5b-113">Contains classes that enable apps to load machine learning models, bind data as inputs, and evaluate the results.</span></span>  |  
| [<span data-ttu-id="18b5b-114">ApplicationModel</span><span class="sxs-lookup"><span data-stu-id="18b5b-114">ApplicationModel</span></span>](/uwp/api/windows.applicationmodel) | <span data-ttu-id="18b5b-115">为应用提供对核心系统功能和有关应用包的运行时信息的访问权限，并处理暂停操作。</span><span class="sxs-lookup"><span data-stu-id="18b5b-115">Provides an app with access to core system functionality and run-time information about the app package, and handles suspend operations.</span></span>  |  
| [<span data-ttu-id="18b5b-116">数据</span><span class="sxs-lookup"><span data-stu-id="18b5b-116">Data</span></span>](/uwp/api/windows.data.html) | <span data-ttu-id="18b5b-117">提供实用程序类，用于处理各种数据格式，包括 HTML、JSON、PDF、文本和 XML。</span><span class="sxs-lookup"><span data-stu-id="18b5b-117">Provides utility classes for working with various data formats, including HTML, JSON, PDF, text, and XML.</span></span>  |  
| [<span data-ttu-id="18b5b-118">设备</span><span class="sxs-lookup"><span data-stu-id="18b5b-118">Devices</span></span>](/uwp/api/windows.devices) | <span data-ttu-id="18b5b-119">此命名空间提供对低级别设备提供程序的访问，包括 ADC、GPIO、I2 C、PWM 和 SPI。</span><span class="sxs-lookup"><span data-stu-id="18b5b-119">This namespace provides access to the low level device providers, including ADC, GPIO, I2 C, PWM, and SPI.</span></span>  |  
| [<span data-ttu-id="18b5b-120">Foundation</span><span class="sxs-lookup"><span data-stu-id="18b5b-120">Foundation</span></span>](/uwp/api/windows.foundation) | <span data-ttu-id="18b5b-121">启用基本的 Windows 运行时功能，包括管理异步操作和访问属性存储。</span><span class="sxs-lookup"><span data-stu-id="18b5b-121">Enables fundamental Windows Runtime functionality, including managing asynchronous operations and accessing property stores.</span></span>  <span data-ttu-id="18b5b-122">此命名空间还定义表示统一资源标识符 \(URI\) 、日期和时间、二维度量和其他基本值的常见值类型。</span><span class="sxs-lookup"><span data-stu-id="18b5b-122">This namespace also defines common value types that represent Uniform Resource Identifier \(URI\), dates and times, 2-D measurements, and other basic values.</span></span>  |  
| [<span data-ttu-id="18b5b-123">游戏</span><span class="sxs-lookup"><span data-stu-id="18b5b-123">Gaming</span></span>](/uwp/api/windows.gaming.input) |<span data-ttu-id="18b5b-124">提供对游戏控制器输入、游戏栏、游戏监视和游戏聊天的访问权限。</span><span class="sxs-lookup"><span data-stu-id="18b5b-124">Provides access to game controller input, the Game bar, game monitoring, and game chat.</span></span>  |  
| [<span data-ttu-id="18b5b-125">全球化</span><span class="sxs-lookup"><span data-stu-id="18b5b-125">Globalization</span></span>](/uwp/api/windows.globalization) | <span data-ttu-id="18b5b-126">为语言配置文件、地理区域和国际日历提供全球化支持。</span><span class="sxs-lookup"><span data-stu-id="18b5b-126">Provides globalization support for language profiles, geographic regions, and international calendars.</span></span>  |  
| [<span data-ttu-id="18b5b-127">显卡</span><span class="sxs-lookup"><span data-stu-id="18b5b-127">Graphics</span></span>](/uwp/api/windows.graphics) | <span data-ttu-id="18b5b-128">提供包含有关绘制图形的信息的基本数据类型。</span><span class="sxs-lookup"><span data-stu-id="18b5b-128">Provides basic data types that contain info on how to draw graphics.</span></span>  <span data-ttu-id="18b5b-129">这些数据结构通常用于定义在使用 CompositionVirtualDrawingSurface 类时绘制的图面大小。</span><span class="sxs-lookup"><span data-stu-id="18b5b-129">These data structs are commonly used to define how large surfaces are drawn when using the CompositionVirtualDrawingSurface class.</span></span>  |  
| [<span data-ttu-id="18b5b-130">管理</span><span class="sxs-lookup"><span data-stu-id="18b5b-130">Management</span></span>](/uwp/api/windows.management) | <span data-ttu-id="18b5b-131">提供强制从移动设备管理 \(MDM\) 设备同步到服务器的功能。</span><span class="sxs-lookup"><span data-stu-id="18b5b-131">Provides capabilities to force a sync from an Mobile Device Management \(MDM\) device to the server.</span></span>  <span data-ttu-id="18b5b-132">此 MDM 同步协议基于开放移动联盟 - 设备管理标准。</span><span class="sxs-lookup"><span data-stu-id="18b5b-132">This MDM sync protocol is based on the Open Mobile Alliance - Device Management standard.</span></span>  |  
| [<span data-ttu-id="18b5b-133">Media</span><span class="sxs-lookup"><span data-stu-id="18b5b-133">Media</span></span>](/uwp/api/windows.media) | <span data-ttu-id="18b5b-134">提供用于创建和用于媒体（如照片、音频录制和视频）的类。</span><span class="sxs-lookup"><span data-stu-id="18b5b-134">Provides classes for creating and working with media such as photos, audio recordings and videos.</span></span>  |  
| [<span data-ttu-id="18b5b-135">网络</span><span class="sxs-lookup"><span data-stu-id="18b5b-135">Networking</span></span>](/uwp/api/windows.networking) | <span data-ttu-id="18b5b-136">提供对网络应用使用的主机名和终结点的访问。</span><span class="sxs-lookup"><span data-stu-id="18b5b-136">Provides access to hostnames and endpoints used by network apps.</span></span>  |  
| [<span data-ttu-id="18b5b-137">感知</span><span class="sxs-lookup"><span data-stu-id="18b5b-137">Perception</span></span>](/uwp/api/windows.perception) | <span data-ttu-id="18b5b-138">包含用于感知用户周围环境的类，使应用可以相对于用户周围的表面和全息影像查找设备的位置和原因。</span><span class="sxs-lookup"><span data-stu-id="18b5b-138">Contains classes for perceiving the user's surroundings, letting apps locate and reason about the device relative to the surfaces and holograms around the user.</span></span>  |  
| [<span data-ttu-id="18b5b-139">安全性</span><span class="sxs-lookup"><span data-stu-id="18b5b-139">Security</span></span>](/uwp/api/windows.security.authentication.identity) | <span data-ttu-id="18b5b-140">提供用于用户身份验证、凭据管理、加密操作和企业数据保护功能的类。</span><span class="sxs-lookup"><span data-stu-id="18b5b-140">Provides classes for user authentication, credentials management, cryptographic operations and enterprise data protection features.</span></span>  |  
| [<span data-ttu-id="18b5b-141">服务</span><span class="sxs-lookup"><span data-stu-id="18b5b-141">Services</span></span>](/uwp/api/windows.services.cortana) | <span data-ttu-id="18b5b-142">提供对 Cortana、地图、Microsoft Store 和目标 \(订阅\) 的访问权限。</span><span class="sxs-lookup"><span data-stu-id="18b5b-142">Provides access to Microsoft services for Cortana, Maps, Microsoft Store and Targeted \(subscription\) content.</span></span>  |  
| [<span data-ttu-id="18b5b-143">存储</span><span class="sxs-lookup"><span data-stu-id="18b5b-143">Storage</span></span>](/uwp/api/windows.storage) | <span data-ttu-id="18b5b-144">提供用于管理文件、文件夹和应用程序设置的类。</span><span class="sxs-lookup"><span data-stu-id="18b5b-144">Provides classes for managing files, folders, and application settings.</span></span>  |  
| [<span data-ttu-id="18b5b-145">系统</span><span class="sxs-lookup"><span data-stu-id="18b5b-145">System</span></span>](/uwp/api/windows.system) | <span data-ttu-id="18b5b-146">启用系统功能，例如启动应用、获取有关用户的信息以及内存分析。</span><span class="sxs-lookup"><span data-stu-id="18b5b-146">Enables system functionality such as launching apps, obtaining information about a user, and memory profiling.</span></span>  |  
| [<span data-ttu-id="18b5b-147">UI</span><span class="sxs-lookup"><span data-stu-id="18b5b-147">UI</span></span>](/uwp/api/windows.ui) | <span data-ttu-id="18b5b-148">向应用提供对核心系统功能和 UI 的运行时信息的访问权限。</span><span class="sxs-lookup"><span data-stu-id="18b5b-148">Provides an app with access to core system functionality and run-time information about the UI.</span></span>  <span data-ttu-id="18b5b-149">**注意**：命名空间中的 API 不适用于 JavaScript 应用 \(它可能会使用等效的基于 Web 标准的 `Windows.UI.Xaml` 技术\) 。</span><span class="sxs-lookup"><span data-stu-id="18b5b-149">**NOTE**:  APIs in the `Windows.UI.Xaml` namespace are not available for JavaScript apps \(which may use the equivalent web standards-based technologies\).</span></span>  |  
| [<span data-ttu-id="18b5b-150">Web</span><span class="sxs-lookup"><span data-stu-id="18b5b-150">Web</span></span>](/uwp/api/windows.web) | <span data-ttu-id="18b5b-151">提供有关 Web 服务操作导致的错误的信息。</span><span class="sxs-lookup"><span data-stu-id="18b5b-151">Provides information on errors resulting from web service operations.</span></span>  |  

<span data-ttu-id="18b5b-152">有关使用情况的更多详细信息，请查看使用 [JavaScript 中的 Windows 运行时](./using-the-windows-runtime-in-javascript.md)。</span><span class="sxs-lookup"><span data-stu-id="18b5b-152">For more details on usage, check out [Using the Windows Runtime in JavaScript](./using-the-windows-runtime-in-javascript.md).</span></span>  <span data-ttu-id="18b5b-153">若要了解如何将网站作为 Windows 应用运行，请尝试"定制 [适用于 Windows 的 PWA"](../progressive-web-apps/windows-features.md) 教程。</span><span class="sxs-lookup"><span data-stu-id="18b5b-153">To learn how to run your website as a Windows app, try the [Tailor your PWA for Windows](../progressive-web-apps/windows-features.md) tutorial.</span></span>  

## <span data-ttu-id="18b5b-154">WebView</span><span class="sxs-lookup"><span data-stu-id="18b5b-154">WebView</span></span>  

<span data-ttu-id="18b5b-155">[Microsoft Edge WebView](../hosting/webview/index.md)控件使你能够在 Windows 10 应用中托管 Web 内容。</span><span class="sxs-lookup"><span data-stu-id="18b5b-155">The [Microsoft Edge WebView](../hosting/webview/index.md) control enables you to host web content within your Windows 10 app.</span></span>  <span data-ttu-id="18b5b-156">这类似于使用 `<iframe>` ，但提供了更多的功能 [和控制](../hosting/webview/index.md#webview-versus-iframe) 体验。</span><span class="sxs-lookup"><span data-stu-id="18b5b-156">This is similar to using an `<iframe>`, but provides a lot [more features and control](../hosting/webview/index.md#webview-versus-iframe) over the experience.</span></span>  

## <span data-ttu-id="18b5b-157">MSApp</span><span class="sxs-lookup"><span data-stu-id="18b5b-157">MSApp</span></span>  

<span data-ttu-id="18b5b-158">[MSApp](./reference/msapp.md)全局对象 \(\) 为基于 JavaScript 的 Windows 10 应用提供排序的帮助程序函数，例如用于基于 Web 标准的和等效的 WinRT 对象类型之间转换的 `window.MSApp` 实用程序。</span><span class="sxs-lookup"><span data-stu-id="18b5b-158">The [MSApp](./reference/msapp.md) global object \(`window.MSApp`\) provides assorted helper functions for JavaScript-based Windows 10 apps, such as utilities for converting between web standards-based and equivalent WinRT object types.</span></span>  
